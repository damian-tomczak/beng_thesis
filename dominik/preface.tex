% TODO interlinia oko≈Ço 1,5
% TODO: dominik please figure how to emphasize hyperlinks on hard copy as we discussed
\newpage
\section{Thesis Conventions}
Every path is started from the main path of project repository.\\
Example Inline Code Snippet: \texttt{puts("Hello World!");}
\\
\begin{lstlisting}[language=c++, caption=Example Code Snippet(./example\_dir/example\_file.cpp)]
std::cout << "Hello World!\n";
\end{lstlisting}
\newpage
\section{Preface English} % TODO: dominik check if it is still up-to-date
The thesis focuses on the architecture and implementation of real-time graphics software for virtual reality devices. To deepen the immersion of being in a virtual environment, the software is extended to support an omnidirectional treadmill. We also cover a topic related to teamwork and software development aimed at third parties. The work aims to develop and solidify programming skills, and knowledge of three-dimensional graphics, focusing on application in fanomatics. We also consider the history, present and future of the 3D graphics industry in the context of video games, and virtual reality.

The thesis begins with a theoretical section presenting the important steps in the evolution of game technology, which is 3D real-time graphics engines, starting with Wolfenstein 3D and ending with multimedia giants like Unreal Engine 5 or Unity; covering the development of the entertainment industry in the last thirty years on the basis of console generations. Special attention is given to the strongly developing virtual reality industry, touching the subject of the early VR of the previous highly experimental age. It concludes with commercial devices, whose popularity exploded in the middle of the last decade with the emergence of a startup in the form of Oculus, to end with observations on the third generation of devices, which is the generation that begins at the time of writing the engineering thesis.

The lion's share of the thesis is oriented around a sample 3D virtual reality graphics engine, named TSEngine in honor of the thesis authors.

This is a program strongly focused on the use of modern technologies centered around obtaining maximum performance at the expense of greater effort and knowledge of the recipient of such solutions. Bearing in mind that our craftsmanship is an intermediate link on the way to the final product (as opposed to traditional software engineering, when the recipient of the application is either a non-technical person or a member of the team in which the solution is developed) and due to the size of the project, we must take create software with suitable architecture and clean code.

Guided by all this, the implementation is carried out, using a high-level programming language such as C++ as defined by the International Organization for Standardization in the document ISO/IEC 14882:2020 ultimately limiting itself to the solutions specified in the same document in the :2017 edition.

For GPU support and communication with virtual reality hardware, we support the Khronos group's multiplatform standards, for the former we use the Vulkan programming interface, while the head-mounted display along with the controllers is driven by the OpenXR API.

Due to the abysmal support for virtual reality devices in the Linux family, we have decided not to multiplatform in this context, however, we still ensure that the software can be developed on any platform through the CMake tool, which will be used to manage the software build and compilation process. Software, however, will be primarily customized and tested in a Windows 10/11 environment and optimized for MSVC compiler capabilities. We will test individual code fragments with unit tests, using the GoogleTest library. The hardware on which we test the software includes HTC VIVE Pro headset, Oculus Quest 2 and NVIDIA's RTX 3000, and 2000 series GPUs.

The engine is to support the Cyberith Virtualizer Elite 2 omnidirectional treadmill, an alternative to traditional movement with controllers. In the context of the software, the use of the treadmill involves the need to support alternative movement, considering not constant movement speed and the distinction between body direction, and direction of movement.

An important premise of the thesis is the use of the Entity Component System (ECS) architectural pattern. This pattern distinguishes three key elements:
\begin{itemize}
    \item Entity - which, by means of an identifier, represents each object in the environment.
    \item Component - which is assigned to an entity by means of a modification of its signature, defines its characteristics, and stores the data needed for use in the system.
    \item System - that is, processes called on all objects that meet a given signature.
\end{itemize}

The use of this architecture is highly recommended for the development of graphics engines for games, as they significantly facilitate the implementation of gameplay elements and optimize the CPU cache.

Another important feature of our software is physically based rendering, which provides a spectacular visual experience with relatively low computational power compared to other non-raster-based lighting methods.

In developing the software, we distinguish the problems and observations involved in creating the tool not only from the perspective of the engine developer, but also focus on the programmers, designers and artists who would benefit from such software. This involves using the right architecture on which they could superstructure their application and without creating too much of a layer of abstraction, which is the bane of current solutions on the market.

Since TSEngine is an engine designed for virtual reality, this comes with its corresponding challenges. The engine needs to display two images on the headset, which we solve at the hardware level by using the Vulkan extension VK\_KHR\_multiview. This is a simplified solution that improves the engine's performance, as it allows rendering a separate image for each eye, with little computational overhead.

Source code of this project is available at:\\
\href{https://github.com/damian-tomczak/tsengine}{https://github.com/damian-tomczak/tsengine}\\
Whereas prebuilt binaries of the project are available at:\\
\href{https://github.com/damian-tomczak/tsengine/releases}{https://github.com/damian-tomczak/tsengine/releases}.\\
Non-compiled \LaTeX thesis is available at:\\
\href{https://github.com/damian-tomczak/beng_thesis}{https://github.com/damian-tomczak/beng\_thesis}\\
Instructions on how to build the code by yourself are detailed in \hyperref[sec:how_to_run]{"Instruction How To Build the Project"} section.

Building a graphics/game engine is a long-term process, so this dissertation does not cover the engine's final form.
On November 9, 2023, the code finally achieved MVP status. The rest of the thesis will be based on the status of the code from that day, unless otherwise stated or fixes are applied to the fragments of interest.
% TODO: add yt link
\newpage
\section{Preface Polish}  % TODO: dominik polish it heheheh
\newpage
\section{Interesting Techniques} % TODO: not only in our engine

\newpage
\subsection{Interesting Engine Techniques}
\subsubsection{Entity Component System}
\label{sec:theory_ecs}
\subsubsection{Reflection System}
\label{sec:refl}

\newpage
\subsection{Interesting Rendering Techniques}
\subsubsection{Differed vs Forward Rendering}

\newpage
\section{Creation of 3D World Immersion}
\[MVP\]
\[MV[2]P[2]\]

\[
\begin{bmatrix}
Orthographic\\
Projection \\
Matrix
\end{bmatrix} 
*
\begin{bmatrix}
X\\
Y\\
Z\\
1\\
\end{bmatrix} 
\]

\[
\begin{bmatrix}
Perspective\\
Projection \\
Matrix
\end{bmatrix} 
*
\begin{bmatrix}
X\\
Y\\
Z\\
1\\
\end{bmatrix} 
\]

\[
a=\frac{h}{w}
\]

\[
f=\frac{1}{tan(\theta / 2)}
\]

\[
\lambda=\frac{zfar}{zfar - znear)}
-
\frac{zfar * znear}{zfar-znear}
\]

\[
\begin{bmatrix}
x\\
y\\
z\\
\end{bmatrix}
\]
Conversion to screen space
\[
\begin{bmatrix}
afx\\
fy\\
\lambda z-\lambda znear\\
\end{bmatrix}
\]
Perspective divide
\[
x/z\ y/z\ z/z
\]

\[
\begin{bmatrix}
(\frac{h}{w})(\frac{1}{tan(\theta/2)}) & 0 & 0 & 0\\
0 & (\frac{1}{tan(\theta/2)}) & 0 & 0\\
0 & 0 & \frac{zfar}{zfar - znear)} & -\frac{zfar * znear}{zfar-znear}\\
0 & 0 & 1 & 0
\end{bmatrix} 
*
\begin{bmatrix}
X\\
Y\\
Z\\
1\\
\end{bmatrix} 
\]

An example of view matrix with camera placed at: 10 5 10:
\[
\begin{bmatrix}
1 & 0 & 0 & -10\\
0 & 1 & 0 & -5\\
0 & 0 & 1 & -10\\
0 & 0 & 0 & 1\\
\end{bmatrix} 
\]

\newpage
\section{Software Testing}
\label{sec:testing}
\subsection{Unit Tests} % TODO: two main that immediately popping up into my mind
\subsection{Smoke Tests}
\newpage
\section{Teamworking}